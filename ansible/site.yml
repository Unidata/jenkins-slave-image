---
- name: Master playbook. Provision VM with all software needed by Jenkins jobs.
  hosts: jenkins-slave
  gather_facts: true  # Needed for all the "ansible_*" facts that we use.
  become: true        # Need for installing packages.

  tasks:
    - name: Update apt cache if needed.
      apt:
        update_cache: yes
        cache_valid_time: 3600  # Update cache if it's been over an hour since the last update.

    - name: Include 'volume' role.
      include_role: name=volume
      tags: [ volume ]

    - name: Include 'libnetcdf-and-deps' role.
      include_role: name=libnetcdf-and-deps
      tags: [ libnetcdf ]

    - name: Include 'ansible-oracle-java' role.
      include_role: name=ansible-oracle-java
      tags: [ java ]

    - name: Include 'ansible-role-docker' role.
      include_role: name=ansible-role-docker
      tags: [ docker ]
